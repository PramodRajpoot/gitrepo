First code
modified from stash file
